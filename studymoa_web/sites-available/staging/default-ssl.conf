<IfModule mod_ssl.c>
	<VirtualHost *:443>
        ServerName stgstudymoa.shop
        ServerAlias stgstudymoa.shop

        ServerAdmin wj@kit-works.com
        DocumentRoot /var/www/html

        SSLEngine on
        Include /etc/letsencrypt/options-ssl-apache.conf
        SSLCertificateFile /etc/letsencrypt/live/stgstudymoa.shop/fullchain.pem
        SSLCertificateKeyFile /etc/letsencrypt/live/stgstudymoa.shop/privkey.pem
        # SSLCertificateChainFile /etc/letsencrypt/live/stgstudymoa.shop/fullchain.pem
        # ErrorLog      ${APACHE_LOG_DIR}/error.log
        # CustomLog ${APACHE_LOG_DIR}/access.log combined
        ErrorLog /dev/stderr
     	TransferLog /dev/stdout

        ProxyPass /api http://app:4000/api
    </VirtualHost>

	<VirtualHost *:443>
		ServerName admin.stgstudymoa.shop

		DocumentRoot /var/www/html/admin

		<Directory "/var/www/html/admin">
			
			RewriteEngine on
			RewriteCond %{REQUEST_FILENAME} -f [OR]
			RewriteCond %{REQUEST_FILENAME} -d
			RewriteRule ^ - [L]
			RewriteRule ^ index.html [L]
		</Directory>

		ProxyPass /api http://app:4000/api

        ErrorLog /dev/stderr
     	TransferLog /dev/stdout

		SSLEngine on
        Include /etc/letsencrypt/options-ssl-apache.conf
        # SSLCertificateFile /etc/letsencrypt/live/stgstudymoa.shop/fullchain.pem
        # SSLCertificateKeyFile /etc/letsencrypt/live/stgstudymoa.shop/privkey.pem
        # SSLCertificateFile /etc/letsencrypt/live/stgstudymoa.shop/cert.pem
		SSLCertificateFile /etc/letsencrypt/live/stgstudymoa.shop/fullchain.pem
        SSLCertificateKeyFile /etc/letsencrypt/live/stgstudymoa.shop/privkey.pem
        # SSLCertificateChainFile /etc/letsencrypt/live/stgstudymoa.shop/fullchain.pem
		<FilesMatch "\.(cgi|shtml|phtml|php)$">
				SSLOptions +StdEnvVars
		</FilesMatch>
		<Directory /usr/lib/cgi-bin>
				SSLOptions +StdEnvVars
		</Directory>
	</VirtualHost>
</IfModule>

